= LoRaWAN 디바이스 설정 및 ChirpStack에 등록

LoRaWAN 디바이스(센서 또는 노드)를 ChirpStack에 설정하고 등록하는 과정은 **LoRaWAN 디바이스**를 **ChirpStack 네트워크 서버**에 연결하고 데이터를 수집할 수 있도록 설정하는 중요한 단계입니다. 이 과정은 주로 다음과 같은 단계로 이루어집니다:

1. **LoRaWAN 디바이스 설정**: 디바이스의 기본 설정 (DevEUI, AppEUI, AppKey 등)을 확인하고 올바르게 구성합니다.
2. **ChirpStack에서 애플리케이션 및 디바이스 등록**: ChirpStack UI를 통해 애플리케이션을 생성하고 디바이스를 등록합니다.
3. **디바이스 데이터 전송 테스트**: 등록한 디바이스가 ChirpStack에 데이터를 전송할 수 있는지 확인합니다.

이제 단계별로 자세히 설명하겠습니다.

---

== 1. **LoRaWAN 디바이스 설정**

LoRaWAN 디바이스(센서 또는 노드)에는 고유한 식별자가 있으며, 이를 기반으로 네트워크에 등록합니다. 설정할 주요 항목은 다음과 같습니다:

== **1.1 주요 식별자 및 키**
* **DevEUI (Device EUI)**: 디바이스의 고유 식별자로, 64비트(16자리의 16진수)로 이루어져 있습니다. LoRaWAN 네트워크에서 이 값을 통해 디바이스를 식별합니다.
* **AppEUI (Application EUI)**: 디바이스가 속한 애플리케이션의 식별자입니다. 64비트(16자리 16진수)로 구성되며, 애플리케이션의 고유 식별값입니다.
* **AppKey (Application Key)**: 128비트(32자리 16진수)의 암호화 키로, 디바이스와 애플리케이션 간의 보안 통신을 위한 키입니다. 이 값은 디바이스가 처음 네트워크에 조인할 때 사용됩니다.

== **1.2 디바이스 설정 확인**
LoRaWAN 디바이스를 ChirpStack에 등록하려면, 먼저 디바이스의 DevEUI, AppEUI, AppKey 등의 값을 확인해야 합니다. 이러한 값들은 보통 디바이스와 함께 제공되는 매뉴얼에서 확인할 수 있습니다.

* DevEUI: 디바이스의 고유 식별자.
* AppEUI: 디바이스가 속한 애플리케이션의 식별자.
* AppKey: 네트워크 조인 시 사용되는 암호화 키.

== **1.3 디바이스 통신 모드**
LoRaWAN 디바이스는 주로 두 가지 통신 모드 중 하나를 사용합니다:
* **OTAA (Over-The-Air Activation)**: 네트워크에 가입하기 위해 디바이스가 처음 켜질 때 서버와 핸드셰이크를 수행하여 네트워크 키(NwkSKey)와 애플리케이션 키(AppSKey)를 받습니다.
* **ABP (Activation By Personalization)**: 디바이스에 미리 할당된 키(NwkSKey, AppSKey)를 사용하여 네트워크에 바로 연결됩니다.

OTAA 방식이 보안이 더 높고, 대부분의 경우 권장됩니다. 여기서는 OTAA를 기준으로 설명합니다.

---

== 2. **ChirpStack에서 애플리케이션 및 디바이스 등록**

디바이스가 데이터를 전송하기 전에 **ChirpStack**에 디바이스와 애플리케이션을 등록해야 합니다. ChirpStack에서 디바이스를 등록하는 절차는 다음과 같습니다.

== **2.1 애플리케이션 생성**

먼저 ChirpStack UI에서 애플리케이션을 생성합니다. 애플리케이션은 여러 LoRaWAN 디바이스가 연결되는 최상위 관리 단위입니다.

1. **ChirpStack UI에 로그인**: 웹 브라우저에서 ChirpStack UI에 접속합니다. 기본 주소는 다음과 같습니다:
+
[source,url]
----
http://<ChirpStack 서버 IP>:8080
----
2. **애플리케이션 메뉴로 이동**: 왼쪽 메뉴에서 "Applications"를 클릭합니다.
3. **새 애플리케이션 생성**:
* "Create" 버튼을 클릭하여 새로운 애플리케이션을 생성합니다.
* **Name**: 애플리케이션의 이름을 입력합니다.
* **Description**: 애플리케이션의 설명을 입력합니다.
* **Service-profile**: 사용할 서비스 프로파일을 선택합니다. 기본 프로파일을 사용할 수 있으며, 필요한 경우 새로운 프로파일을 생성할 수 있습니다.
* **Payload codec**: 디바이스에서 전송되는 데이터를 처리하기 위한 코덱을 선택합니다. 필요에 따라 커스텀 코덱을 추가할 수 있습니다.

== **2.2 디바이스 등록**

애플리케이션이 생성되면 해당 애플리케이션에 디바이스를 추가해야 합니다.

1. **애플리케이션 상세 페이지로 이동**: 생성한 애플리케이션의 이름을 클릭하여 상세 페이지로 이동합니다.

2. **새 디바이스 추가**:
* "Devices" 탭을 클릭한 후 "Create" 버튼을 클릭합니다.
* **Device EUI**: LoRaWAN 디바이스의 DevEUI 값을 입력합니다.
* **Name**: 디바이스 이름을 입력합니다.
* **Description**: 디바이스에 대한 설명을 입력합니다.
* **Device-profile**: 사용할 디바이스 프로파일을 선택합니다. 기본 프로파일을 사용할 수 있으며, 필요에 따라 새로운 프로파일을 생성할 수 있습니다.
* **Application key**: OTAA를 사용하는 경우, **AppKey** 값을 입력합니다. 이 값은 디바이스가 네트워크에 가입할 때 사용됩니다.

3. **디바이스 저장**: 모든 정보를 입력한 후 "Create device" 버튼을 눌러 디바이스를 등록합니다.

---

== 3. **디바이스 데이터 전송 테스트**

== **3.1 디바이스 활성화**

디바이스가 ChirpStack에 성공적으로 등록되었으면, 디바이스를 전원에 연결하거나 재부팅하여 네트워크에 접속하도록 합니다. OTAA 방식을 사용하는 경우, 디바이스는 처음 전원이 들어오면 ChirpStack 네트워크에 조인 요청을 보냅니다.

== **3.2 디바이스 통신 상태 확인**

디바이스가 네트워크에 성공적으로 연결되었는지 확인하려면, ChirpStack UI에서 디바이스의 상태를 확인할 수 있습니다.

1. **디바이스 페이지로 이동**: 등록된 디바이스의 이름을 클릭하여 상세 페이지로 이동합니다.

2. **데이터 전송 로그 확인**:
* 디바이스의 페이지에서 "Live LoRaWAN Frames" 탭을 선택하면 디바이스에서 전송된 패킷을 실시간으로 볼 수 있습니다.
* 여기에서 디바이스가 데이터를 전송하고 있는지, ChirpStack이 이를 수신하고 처리하고 있는지 확인할 수 있습니다.

3. **데이터 페이로드 확인**:
* "Device data" 탭에서는 디바이스에서 전송된 실제 데이터 페이로드를 확인할 수 있습니다.
* 페이로드 코덱을 설정한 경우, 수신된 데이터가 해석되어 표시됩니다.

== **3.3 네트워크 조인 확인 (OTAA의 경우)**

OTAA를 사용하는 경우, "Live LoRaWAN Frames" 탭에서 **Join Request**와 **Join Accept** 메시지를 확인할 수 있습니다. 이 메시지들이 성공적으로 처리되면 디바이스가 네트워크에 성공적으로 연결된 것입니다.

---

== 4. 추가 설정 및 모니터링

ChirpStack UI를 통해 추가적인 설정과 모니터링을 수행할 수 있습니다. 예를 들어:

* **게이트웨이 상태 모니터링**: 여러 게이트웨이가 설치된 경우, 각 게이트웨이의 상태를 모니터링할 수 있습니다.
* **애플리케이션 관리**: 애플리케이션에서 수집된 데이터를 다른 시스템으로 전송하거나, 데이터베이스에 저장할 수 있도록 설정할 수 있습니다.
* **경고 및 알림 설정**: 특정 조건에 도달했을 때 알림을 받을 수 있도록 경고 설정을 할 수 있습니다.

---

== 결론

LoRaWAN 디바이스를 설정하고 **ChirpStack**에 등록하는 과정은 **DevEUI, AppEUI, AppKey**와 같은 중요한 정보를 바탕으로 디바이스를 네트워크에 연결하는 과정입니다. ChirpStack UI를 통해 **애플리케이션**을 생성하고 **디바이스**를 등록한 후, 데이터가 성공적으로 전송되는지 확인할 수 있습니다. 이 과정은 IoT 시스템에서 데이터를 수집하고 관리하는 중요한 역할을 합니다.

---

[cols="1a,1a,1a",grid=none,frame=none]
|===
<s|
^s|link:../../../README.md[목차]
>s|
|===