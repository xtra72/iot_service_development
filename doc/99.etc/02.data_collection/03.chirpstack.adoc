== ChirpStack이란?

**ChirpStack**은 오픈소스 **LoRaWAN 네트워크 서버 스택**으로, **LoRaWAN 기반의 IoT 솔루션**을 구축할 때 사용되는 주요 소프트웨어입니다. ChirpStack은 **LoRaWAN 게이트웨이**와 **IoT 디바이스** 간의 데이터를 관리하고, 이를 네트워크를 통해 **애플리케이션 서버**로 전달하는 역할을 합니다.

ChirpStack은 **게이트웨이 브리지(Gateway Bridge)**, **네트워크 서버(Network Server)**, **애플리케이션 서버(Application Server)**로 구성되며, 각 요소가 LoRaWAN 네트워크를 구축하고 데이터를 처리하는 데 핵심적인 역할을 담당합니다. 이 구성 요소들은 LoRaWAN 프로토콜을 통해 **저전력, 장거리 통신**을 지원하는 IoT 애플리케이션을 구축하는 데 필요한 모든 기능을 제공합니다.

== 1. **ChirpStack Gateway Bridge**

**ChirpStack Gateway Bridge**는 LoRaWAN **게이트웨이**와 **네트워크 서버** 간의 데이터 전송을 관리하는 중요한 역할을 합니다. 주로 게이트웨이에서 수집된 LoRa 패킷을 네트워크 서버로 전송하고, 반대로 네트워크 서버에서 게이트웨이로 전송되는 메시지를 관리합니다.

=== **주요 역할:**
* **데이터 변환**: 게이트웨이에서 수신한 LoRa PHY 패킷을 JSON 형식으로 변환하고, 이를 MQTT 또는 다른 프로토콜을 통해 네트워크 서버로 전달.
* **게이트웨이 관리**: 게이트웨이의 상태를 모니터링하고, 네트워크 서버로 상태 보고서를 전송합니다. 예를 들어, 게이트웨이가 활성 상태인지, 얼마나 많은 패킷을 처리했는지 등의 상태 정보를 전송합니다.
* **프로토콜 브리지**: 게이트웨이와 네트워크 서버 간의 LoRa 프레임 전송에서 발생하는 여러 통신 프로토콜 차이를 다리처럼 연결하는 역할을 합니다.

=== **게이트웨이 브리지의 기능:**
* **MQTT 브로커를 통한 통신**: 게이트웨이 브리지는 MQTT를 사용하여 게이트웨이와 네트워크 서버 간의 데이터를 전송합니다. 이를 통해 경량 메시징 시스템을 기반으로 실시간 데이터를 교환할 수 있습니다.
* **비동기 처리**: 게이트웨이와 네트워크 서버 간의 데이터 전송은 비동기로 처리되며, 네트워크 서버에서 처리된 다운링크 메시지도 게이트웨이로 전송할 수 있습니다.

== 2. **ChirpStack Network Server**

**ChirpStack Network Server**는 LoRaWAN 네트워크에서 가장 핵심적인 역할을 수행하는 **중앙 처리 시스템**으로, **LoRaWAN 게이트웨이**로부터 수집된 데이터를 처리하고, 네트워크 상의 장치들을 관리합니다. 이 서버는 **LoRaWAN 프로토콜**의 관리와 데이터 라우팅을 처리합니다.

=== **주요 역할:**
* **LoRaWAN 프로토콜 처리**: LoRaWAN 장치가 게이트웨이를 통해 전송하는 모든 데이터를 처리하고, LoRaWAN의 MAC (Medium Access Control) 계층을 관리합니다.
* **인증 및 보안**: 네트워크 서버는 각 LoRaWAN 장치의 인증을 관리하고, 데이터를 암호화 및 복호화하여 안전한 데이터 전송을 보장합니다.
* **장치 관리**: 네트워크에 연결된 LoRaWAN 장치들을 관리하고, 장치의 상태를 모니터링하며, 장치 간 데이터 전송을 처리합니다.
* **데이터 라우팅**: LoRaWAN 장치에서 전송된 데이터를 애플리케이션 서버로 라우팅하며, 애플리케이션 서버에서 보내는 다운링크 메시지를 장치로 전달.

=== **네트워크 서버의 기능:**
* **패킷 복호화 및 처리**: LoRaWAN 장치가 보낸 암호화된 데이터를 복호화하고, 이 데이터가 유효한지 검증한 후, 필요한 경우 데이터를 애플리케이션 서버로 전달합니다.
* **클래스 A, B, C 지원**: 네트워크 서버는 LoRaWAN 프로토콜의 다양한 동작 모드(Class A, B, C)를 지원하여 장치의 통신 패턴에 맞는 네트워크 동작을 처리합니다.
* **멀티캐스트 및 장치 위치 추적**: LoRaWAN 네트워크 서버는 멀티캐스트 패킷을 지원하며, GPS가 장착된 게이트웨이를 통해 장치 위치를 추적할 수 있습니다.

== 3. **ChirpStack Application Server**

**ChirpStack Application Server**는 LoRaWAN 네트워크에서 수집된 데이터를 **최종 애플리케이션**으로 전달하고, **IoT 애플리케이션**에서 사용하는 데이터를 관리하는 역할을 수행합니다. 애플리케이션 서버는 사용자가 정의한 로직을 기반으로 데이터를 처리하고, 이 데이터를 외부 시스템에 전달하거나 사용자에게 제공하는 **인터페이스** 역할을 합니다.

=== **주요 역할:**
* **데이터 처리 및 변환**: 네트워크 서버에서 전송된 LoRaWAN 데이터를 사용자가 이해할 수 있는 형태로 변환합니다. 예를 들어, 원시 LoRaWAN 데이터를 JSON, XML 또는 기타 형식으로 변환하여 애플리케이션에 전달합니다.
* **API 제공**: 외부 애플리케이션에서 데이터를 가져가거나 장치 제어를 할 수 있는 REST API 또는 MQTT 인터페이스를 제공합니다.
* **사용자 관리 및 애플리케이션 구독**: 여러 사용자가 여러 애플리케이션을 사용할 수 있도록 지원하며, 각 사용자와 애플리케이션에 대해 권한을 관리합니다.
* **다운링크 메시지 처리**: 사용자가 애플리케이션에서 장치로 명령을 보낼 때, 이 명령을 처리하고, 네트워크 서버를 통해 LoRaWAN 장치로 명령을 전달합니다.

=== **애플리케이션 서버의 기능:**
* **REST 및 MQTT API 제공**: ChirpStack Application Server는 데이터를 다른 애플리케이션과 통합할 수 있도록 REST API와 MQTT를 통해 데이터를 전달합니다.
* **멀티테넌시 지원**: 하나의 서버에서 여러 애플리케이션과 장치를 관리할 수 있는 구조로 설계되어, 다양한 프로젝트와 사용자 그룹을 지원할 수 있습니다.
* **통합 및 데이터 처리**: 애플리케이션 서버는 IoT 시스템에서 수집된 데이터를 처리 및 저장하며, 필요에 따라 외부 시스템과 통합할 수 있는 기능을 제공합니다. 예를 들어, 수집된 데이터를 **InfluxDB**, **Grafana**, **Node-RED**와 같은 데이터베이스 및 시각화 도구와 연동할 수 있습니다.

== ChirpStack의 전체적인 데이터 흐름

1. **게이트웨이 브리지**는 LoRaWAN 게이트웨이에서 수집한 데이터를 **MQTT**를 통해 **네트워크 서버**로 전송합니다.
2. **네트워크 서버**는 수집된 데이터를 처리하고 인증을 수행하며, 패킷을 복호화한 후 **애플리케이션 서버**로 전달합니다.
3. **애플리케이션 서버**는 데이터를 처리하고, 이를 사용자가 이해할 수 있는 형식으로 변환하여 외부 애플리케이션 또는 사용자에게 전달합니다. 또한, **다운링크 메시지**를 장치로 전달하는 역할도 수행합니다.

== 정리

* **ChirpStack**은 **LoRaWAN 기반의 IoT 솔루션**을 구축하는 데 중요한 역할을 하는 **오픈소스 네트워크 서버 스택**입니다.
* ChirpStack은 **게이트웨이 브리지**, **네트워크 서버**, **애플리케이션 서버**로 구성되어 있으며, 이 세 가지 구성 요소가 협력하여 **LoRaWAN 네트워크**의 데이터를 관리하고, 최종 애플리케이션에 데이터를 전달합니다.
* 각 구성 요소는 **데이터 수집**, **전송**, **처리**에서 중요한 역할을 하며, 이를 통해 IoT 디바이스와 애플리케이션 간의 원활한 통신과 상호작용을 제공합니다.
** **Gateway Bridge**: LoRaWAN 게이트웨이와 네트워크 서버 간의 통신을 담당.
** **Network Server**: LoRaWAN 프로토콜의 핵심 처리 시스템으로, 장치 관리와 데이터 라우팅을 담당.
** **Application Server**: 최종 애플리케이션으로 데이터를 전달하고, 사용자 정의 데이터를 처리하며, API를 통해 데이터를 제공.
* ChirpStack은 이 세 가지 역할을 통해 IoT 솔루션에서 데이터를 효율적으로 관리하고 처리할 수 있도록 돕습니다.

---

[cols="1a,1a,1a",grid=none,frame=none]
|===
<s|
^s|link:../../../README.md[목차]
>s|
|===